Got it! Here's the updated script that works with the active model and the active table in PowerDesigner:

```vb
Option Explicit

Dim objPowerDesigner, objModel, objFSO, objFile
Dim table, tableName, schemaName, avroPath, column, firstColumn
Dim outputFolder, selectedTable

' Start PowerDesigner
Set objPowerDesigner = CreateObject("PowerDesigner.Application")
If objPowerDesigner Is Nothing Then
    MsgBox "Error: PowerDesigner is not running.", vbCritical
    WScript.Quit
End If

' Get the active model
Set objModel = objPowerDesigner.ActiveModel
If objModel Is Nothing Then
    MsgBox "Error: No active model found.", vbCritical
    WScript.Quit
End If

' Get the selected table
Set selectedTable = objPowerDesigner.ActiveSelection.Item(0)
If selectedTable Is Nothing Or selectedTable.ClassName <> "Table" Then
    MsgBox "Error: No table selected or the selected item is not a table.", vbCritical
    WScript.Quit
End If

' Extract schema and table name
schemaName = selectedTable.Owner
tableName = selectedTable.Name

' Output folder for Avro schema files
outputFolder = "C:\AvroSchemas\"

' Create File System Object
Set objFSO = CreateObject("Scripting.FileSystemObject")

' Create output folder if it doesn't exist
If Not objFSO.FolderExists(outputFolder) Then
    objFSO.CreateFolder(outputFolder)
End If

' Generate Avro schema
avroPath = outputFolder & "\" & schemaName & "_" & tableName & ".avsc"
Set objFile = objFSO.CreateTextFile(avroPath, True)
objFile.WriteLine "{"
objFile.WriteLine """type"": ""record"","
objFile.WriteLine """name"": """ & tableName & ""","
objFile.WriteLine """namespace"": """ & schemaName & ""","
objFile.WriteLine """fields"": ["

firstColumn = True

' Extract columns for the given table
For Each column In selectedTable.Columns
    If Not firstColumn Then objFile.WriteLine ","
    firstColumn = False
    
    objFile.WriteLine "  {"
    objFile.WriteLine "    ""name"": """ & column.Name & ""","
    objFile.WriteLine "    ""type"": """ & MapDataType(column.DataType) & """"
    objFile.WriteLine "  }"
Next

objFile.WriteLine "]"
objFile.WriteLine "}"
objFile.Close

MsgBox "Avro schema generated: " & avroPath, vbInformation

' Clean up
Set objPowerDesigner = Nothing
Set objModel = Nothing
Set objFSO = Nothing

' Function to map Oracle data types to Avro types
Function MapDataType(oracleType)
    Select Case UCase(oracleType)
        Case "VARCHAR2", "CHAR", "NVARCHAR2", "CLOB"
            MapDataType = "string"
        Case "NUMBER", "FLOAT", "BINARY_FLOAT", "BINARY_DOUBLE"
            MapDataType = "double"
        Case "DATE", "TIMESTAMP"
            MapDataType = "string" ' Handle as ISO date-time strings
        Case Else
            MapDataType = "string"
    End Select
End Function
```

This version of the script will work with the currently active model and the currently selected table in PowerDesigner. Just make sure to have the table you want to work with selected before running the script. Let me know if you need further assistance!