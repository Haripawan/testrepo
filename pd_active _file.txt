Option Explicit

Dim objPowerDesigner, objModel, objDiagram, objSelection, selectedTable
Dim column, i

' Get the active PowerDesigner application instance
Set objPowerDesigner = CreateObject("PowerDesigner.Application")

' Check if PowerDesigner is running
If objPowerDesigner Is Nothing Then
    MsgBox "Error: PowerDesigner is not running.", vbCritical
    WScript.Quit
End If

' Get the active model
Set objModel = objPowerDesigner.ActiveModel

' Check if a model is open
If objModel Is Nothing Then
    MsgBox "Error: No active model is currently open.", vbCritical
    WScript.Quit
End If

' Get the active diagram (needed for selection)
Set objDiagram = objModel.ActiveDiagram

' Check if there is an active diagram
If objDiagram Is Nothing Then
    MsgBox "Error: No active diagram found. Please open a diagram.", vbCritical
    WScript.Quit
End If

' Get the selected objects from the active diagram
Set objSelection = objDiagram.GetSelectedObjects

' Check if any object is selected
If objSelection.Count = 0 Then
    MsgBox "Error: No object selected in the active diagram.", vbCritical
    WScript.Quit
End If

' Loop through selected objects to find a Table
For i = 0 To objSelection.Count - 1
    If TypeName(objSelection.Item(i)) = "Table" Then
        Set selectedTable = objSelection.Item(i)
        Exit For
    End If
Next

' Check if a table was found in the selection
If selectedTable Is Nothing Then
    MsgBox "Error: No table selected. Please select a table.", vbCritical
    WScript.Quit
End If

' Display the selected table name
MsgBox "Selected Table: " & selectedTable.Name

' Loop through columns of the selected table and display their names and data types
Dim columnDetails
columnDetails = "Columns in Table " & selectedTable.Name & ":" & vbCrLf

For Each column In selectedTable.Columns
    columnDetails = columnDetails & "- " & column.Name & " (" & column.DataType & ")" & vbCrLf
Next

MsgBox columnDetails, vbInformation, "Table Columns"